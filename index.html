<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ê¿ˆë“œë¦¼ í†µí•© ì¸í…Œì´í¬ ì‹œìŠ¤í…œ</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <style>
        /* [ë””ìì¸: íƒœë¸”ë¦¿ ê°€ë…ì„± ìµœì í™” + ì¸ì‡„ ì–‘ì‹] */
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        
        :root { --primary: #007AFF; --bg: #F2F2F7; --card: #FFFFFF; --text: #1C1C1E; --danger: #FF3B30; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; line-height: 1.6; }
        
        .container { max-width: 800px; margin: 0 auto; }
        .card { background: var(--card); border-radius: 16px; padding: 30px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        
        /* ì…ë ¥ ìš”ì†Œ ìŠ¤íƒ€ì¼ */
        h1, h2 { text-align: center; color: #333; }
        label { display: block; margin-bottom: 10px; font-weight: bold; font-size: 1.1em; }
        input[type="text"], input[type="date"], input[type="number"], select {
            width: 100%; padding: 15px; border: 1px solid #ccc; border-radius: 12px; font-size: 1.1em; box-sizing: border-box; margin-bottom: 20px;
        }

        /* ë¼ë””ì˜¤ ë²„íŠ¼ (ì¹´ë“œí˜• í„°ì¹˜) */
        .radio-group { display: flex; gap: 10px; justify-content: space-between; margin-bottom: 30px; }
        .radio-group label {
            flex: 1; background: #fff; border: 2px solid #eee; border-radius: 12px; padding: 20px 5px;
            text-align: center; cursor: pointer; transition: 0.2s; font-weight: normal; display: flex; flex-direction: column; justify-content: center;
        }
        .radio-group input { display: none; }
        .radio-group label:has(input:checked) { border-color: var(--primary); background: #E5F1FF; color: var(--primary); font-weight: bold; }

        /* ì²´í¬ë°•ìŠ¤ ê·¸ë£¹ */
        .checkbox-group label { display: inline-block; background: #fff; border: 1px solid #ddd; padding: 10px 15px; border-radius: 20px; margin: 5px; cursor: pointer; font-weight: normal; }
        .checkbox-group input { display: none; }
        .checkbox-group label:has(input:checked) { background: var(--primary); color: white; border-color: var(--primary); }

        .btn { width: 100%; padding: 20px; background: var(--primary); color: white; border: none; border-radius: 12px; font-size: 1.2em; font-weight: bold; cursor: pointer; margin-top: 20px; }
        .btn.admin { background: #333; margin-top: 50px; font-size: 0.9em; padding: 10px; }

        /* í™”ë©´ ì œì–´ */
        .hidden { display: none !important; }
        
        /* [ì¸ì‡„ ì „ìš© ìŠ¤íƒ€ì¼ - ë§¤ë‰´ì–¼ ì–‘ì‹ ì¤€ìˆ˜] */
        @media print {
            body { background: white; padding: 0; font-size: 12px; }
            .no-print, .btn, .input-group, #youth-view { display: none !important; }
            #admin-view, #report-area { display: block !important; }
            .card { box-shadow: none; border: none; padding: 0; margin: 0; border-radius: 0; }
            
            /* ê²°ê³¼í‘œ ìŠ¤íƒ€ì¼ (ë§¤ë‰´ì–¼ í‘œ ì–‘ì‹) */
            .report-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 12px; }
            .report-table th, .report-table td { border: 1px solid #000; padding: 6px; text-align: center; }
            .report-table th { background: #f0f0f0; font-weight: bold; }
            .report-header { text-align: center; border: 2px solid #000; padding: 10px; margin-bottom: 20px; }
            .section-title { font-size: 14px; font-weight: bold; margin-top: 20px; border-bottom: 1px solid #000; padding-bottom: 5px; }
            .page-break { page-break-before: always; }
            .danger-text { color: red !important; font-weight: bold; }
        }
    </style>
</head>
<body>

<div id="youth-view" class="container">
    <div id="step-login" class="card">
        <h1>ğŸŒ± ê¿ˆë“œë¦¼ ì¸í…Œì´í¬</h1>
        <p>í™˜ì˜í•©ë‹ˆë‹¤. ë³¸ ì„¤ë¬¸ì€ ì—¬ëŸ¬ë¶„ì—ê²Œ ê¼­ ë§ëŠ” ì§€ì›ì„ í•˜ê¸° ìœ„í•œ ê¸°ì´ˆ ìë£Œì…ë‹ˆë‹¤.</p>
        <label>ì´ë¦„ <input type="text" id="userName"></label>
        <label>ìƒë…„ì›”ì¼ <input type="date" id="userBirth"></label>
        <button class="btn" onclick="startSurvey()">ì‹œì‘í•˜ê¸°</button>
        <button class="btn admin" onclick="showAdminLogin()">ê´€ë¦¬ì ëª¨ë“œ</button>
    </div>

    <div id="step-survey" class="card hidden">
        <h2>1. í¬ë§ ì„œë¹„ìŠ¤ ë° ê¸°ì´ˆ ì¡°ì‚¬</h2>
        
        <label>ğŸ« í•™êµë¥¼ ê·¸ë§Œë‘”(ì¤‘ë‹¨í•œ) ì£¼ëœ ì´ìœ ëŠ”? (ê°€ì¥ í° ì´ìœ  1ê°œ)</label>
        <select id="dropReason">
            <option value="ì‹¬ë¦¬">ì‹¬ë¦¬Â·ì •ì„œì  ì–´ë ¤ì›€</option>
            <option value="í•™ì—…">ê³µë¶€(ê²€ì •ê³ ì‹œ, ëŒ€ì… ë“±)ë¥¼ ë‚˜ë§Œì˜ ë°©ì‹ìœ¼ë¡œ í•˜ê³  ì‹¶ì–´ì„œ</option>
            <option value="ê´€ê³„">í•™êµ ì¹œêµ¬/ì„ ìƒë‹˜ê³¼ì˜ ê´€ê³„ ì–´ë ¤ì›€</option>
            <option value="ì§„ë¡œ">íŠ¹ê¸°/ì ì„±ì„ ì‚´ë¦¬ê±°ë‚˜ ì§„ë¡œë¥¼ ì°¾ê¸° ìœ„í•´</option>
            <option value="ê¸°íƒ€">ê¸°íƒ€ (ê²½ì œì  ì‚¬ì •, ê±´ê°• ë“±)</option>
        </select>

        <label>ğŸ ê°€ì¥ ë°›ê³  ì‹¶ì€ ì„œë¹„ìŠ¤ëŠ”? (ìš°ì„ ìˆœìœ„ 1ìœ„)</label>
        <select id="wants1">
            <option value="ìƒë‹´">ì‹¬ë¦¬ìƒë‹´ (ìš°ìš¸, ë¶ˆì•ˆ, ì§„ë¡œê³ ë¯¼ ë“±)</option>
            <option value="í•™ì—…">í•™ì—…ì§€ì› (ê²€ì •ê³ ì‹œ, ìˆ˜ëŠ¥ê³µë¶€, ë©˜í† ë§)</option>
            <option value="ìë¦½">ìë¦½ì§€ì› (ìê²©ì¦, ì¸í„´ì‹­, ê¸°ìˆ í›ˆë ¨)</option>
            <option value="í™œë™">ë¬¸í™”/ë™ì•„ë¦¬ í™œë™ (ìº í”„, ì·¨ë¯¸ ë“±)</option>
            <option value="ìƒí™œ">ìƒí™œì§€ì› (ê¸‰ì‹, ê±´ê°•ê²€ì§„, ê²½ì œì  ì§€ì›)</option>
        </select>

        <button class="btn" onclick="goScale()">ë‹¤ìŒ (ì²™ë„ ê²€ì‚¬)</button>
    </div>

    <div id="step-scale" class="card hidden">
        <h2 id="scale-title">ì²™ë„ ê²€ì‚¬ ì§„í–‰ ì¤‘</h2>
        <p class="guide-text">ì†”ì§í•˜ê²Œ ì²´í¬í•´ ì£¼ì„¸ìš”.</p>
        <div id="question-area"></div>
        <button class="btn" onclick="submitData()">ì œì¶œí•˜ê¸°</button>
    </div>
    
    <div id="step-end" class="card hidden" style="text-align:center;">
        <h1>âœ… ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</h1>
        <p>ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤. íƒœë¸”ë¦¿ì„ ì„ ìƒë‹˜ê»˜ ë“œë ¤ì£¼ì„¸ìš”.</p>
        <button class="btn" onclick="location.reload()">ì²˜ìŒìœ¼ë¡œ</button>
    </div>
</div>

<div id="admin-view" class="container hidden">
    <div id="admin-login" class="card no-print">
        <h2>ğŸ”’ ê´€ë¦¬ì ì ‘ì†</h2>
        <input type="password" id="adminPw" placeholder="ë¹„ë°€ë²ˆí˜¸">
        <button class="btn" onclick="verifyAdmin()">í™•ì¸</button>
        <button class="btn" style="background:#999;" onclick="location.reload()">ë‚˜ê°€ê¸°</button>
    </div>

    <div id="admin-dashboard" class="card hidden no-print">
        <h2>ğŸ“‹ ì°¸ì—¬ ì²­ì†Œë…„ ëª©ë¡</h2>
        <ul id="user-list" style="list-style:none; padding:0;"></ul>
        <button class="btn" style="background:#666;" onclick="location.reload()">ë¡œê·¸ì•„ì›ƒ</button>
    </div>

    <div id="report-area" class="hidden">
        <div class="report-header">
            <h2>í•™êµ ë°– ì²­ì†Œë…„ í†µí•© ì§„ë‹¨ ê²°ê³¼ì§€</h2>
            <p>ì´ë¦„: <span id="r-name"></span> | ìƒë…„ì›”ì¼: <span id="r-birth"></span> | ê²€ì‚¬ì¼: <span id="r-date"></span></p>
        </div>

        <div class="section-title">â… . ê¸°ì´ˆ ì¡°ì‚¬ ë° í¬ë§ ì„œë¹„ìŠ¤ [cite: 16]</div>
        <table class="report-table">
            <tr><th>í•™ì—…ì¤‘ë‹¨ ì‚¬ìœ </th><td id="r-reason"></td><th>1ìˆœìœ„ í¬ë§ì„œë¹„ìŠ¤</th><td id="r-want"></td></tr>
        </table>

        <div class="section-title">â…¡. ìë¦½ì—­ëŸ‰ ì²™ë„ ê²°ê³¼ (ì ìˆ˜ê°€ ë‚®ì„ìˆ˜ë¡ ìœ„í—˜) [cite: 17]</div>
        <table class="report-table">
            <thead><tr><th>ì˜ì—­</th><th>ë‚˜ì˜ ì ìˆ˜</th><th>ê¸°ì¤€(ì ˆë‹¨) ì ìˆ˜</th><th>íŒì •</th></tr></thead>
            <tbody id="r-jarip-body"></tbody>
        </table>

        <div class="section-title">â…¢. ì‹¬ë¦¬ì •ì„œÂ·í™˜ê²½ ì²™ë„ ê²°ê³¼ (ì ìˆ˜ê°€ ë†’ì„ìˆ˜ë¡ ìœ„í—˜) [cite: 18]</div>
        <table class="report-table">
            <thead><tr><th>ì˜ì—­</th><th>ë‚˜ì˜ ì ìˆ˜</th><th>ê¸°ì¤€(ì ˆë‹¨) ì ìˆ˜</th><th>íŒì •</th></tr></thead>
            <tbody id="r-simni-body"></tbody>
        </table>

        <div class="section-title" style="color:red;">ğŸš¨ ê¸´ê¸‰ í™•ì¸ ë° ì¶”ê°€ íƒìƒ‰ ê°€ì´ë“œ </div>
        <div id="r-guide" style="border:1px solid red; padding:10px; font-size:12px;"></div>

        <div class="page-break"></div>
        <h3>[ë³„ì²¨] ì „ì²´ ë¬¸í•­ ì‘ë‹µ ë°ì´í„°</h3>
        <div id="r-raw-data" style="font-size:11px; column-count: 2;"></div>
        
        <button class="btn no-print" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„ / PDF ì €ì¥</button>
        <button class="btn no-print" style="background:#999;" onclick="closeReport()">ë‹«ê¸°</button>
    </div>
</div>

<script>
    // ============================================================
    // 1. Firebase ì„¤ì • (YOUR_API_KEYë¥¼ ë³¸ì¸ ê²ƒìœ¼ë¡œ ë³€ê²½ í•„ìˆ˜)
    // ============================================================
    const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_PROJECT_ID.appspot.com",
        messagingSenderId: "YOUR_SENDER_ID",
        appId: "YOUR_APP_ID"
    };
    
    // ì´ ë¶€ë¶„ì€ ì‹¤ì œ API í‚¤ê°€ ì—†ìœ¼ë©´ ì—ëŸ¬ê°€ ë‚˜ë¯€ë¡œ, 
    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€(ë¸Œë¼ìš°ì € ì €ì¥ì†Œ) ëª¨ë“œë¡œ ë™ì‘í•˜ê²Œ í•˜ëŠ” Fallback ì½”ë“œë¥¼ ë„£ìŠµë‹ˆë‹¤.
    let db;
    try {
        firebase.initializeApp(firebaseConfig);
        db = firebase.firestore();
    } catch(e) {
        console.warn("Firebase ì„¤ì •ì´ ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ëª¨ë“œë¡œ ë™ì‘í•©ë‹ˆë‹¤.");
    }

    // ============================================================
    // 2. ë°ì´í„° ë° ë¡œì§
    // ============================================================
    
    // [ë°ì´í„°ë² ì´ìŠ¤: ë§¤ë‰´ì–¼ ë¬¸í•­ DB]
    // 13-24ì„¸ìš© ê¸°ì¤€ (ì˜ˆì‹œ ë‹¨ì¶•, ì‹¤ì œ ì „ì²´ êµ¬í˜„ì‹œ DB_YOUTH ì „ì²´ ë³µì‚¬)
    const QUESTIONS = {
        jarip: [
            {no:1, t:"ë‚˜ëŠ” ê°€ì¹˜ìˆëŠ” ì‚¬ëŒì´ë‹¤", d:"ìì¡´ê°"},
            {no:7, t:"ë‚˜ëŠ” ë§¡ê²¨ì§„ ì¼ì€ ëê¹Œì§€ í•˜ë ¤ê³  ë…¸ë ¥í•œë‹¤", d:"ì„±ì‹¤ì„±"},
            {no:2, t:"ë‚˜ëŠ” ë‚´ê°€ ë¬´ì—‡ì„ ì•Œê³  ëª¨ë¥´ëŠ”ì§€ íŒë‹¨í•  ìˆ˜ ìˆë‹¤", d:"í•™ì—…íš¨ëŠ¥ê°"},
            // ... (ì „ì²´ ë¬¸í•­ í•„ìš”)
        ],
        simni: [
            {no:1, t:"ì§€ë‚œ 1ë‹¬ê°„ ìŠ¬í”„ê±°ë‚˜ ìš°ìš¸í•  ë•Œê°€ ìì£¼ ìˆë‹¤", d:"ìš°ìš¸Â·ë¶ˆì•ˆ"},
            {no:48, t:"ì§€ë‚œ 3ê°œì›”ê°„ ìì‚´ì„ ìƒê°í•´ ë³¸ ì  ìˆë‹¤", d:"ìì‚´", crit:true}, // Red Flag
            {no:15, t:"ë‚´ê²ŒëŠ” ì†ë§ˆìŒì„ í„°ë†“ì„ ì¹œêµ¬ê°€ ìˆë‹¤", d:"ë˜ë˜í™˜ê²½", rev:true}, // ì—­ì±„ì  [cite: 1326]
            // ... (ì „ì²´ ë¬¸í•­ í•„ìš”)
        ]
    };

    let currentUser = {};
    let answers = {};

    function startSurvey() {
        const name = document.getElementById('userName').value;
        const birth = document.getElementById('userBirth').value;
        if(!name || !birth) return alert("ì´ë¦„ê³¼ ìƒë…„ì›”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        
        currentUser = { name, birth, date: new Date().toLocaleDateString() };
        
        // ë‚˜ì´ ê³„ì‚°
        const age = new Date().getFullYear() - new Date(birth).getFullYear();
        currentUser.age = age;
        currentUser.type = (age >= 13) ? "youth" : "child";

        document.getElementById('step-login').classList.add('hidden');
        document.getElementById('step-survey').classList.remove('hidden');
    }

    function goScale() {
        // í¬ë§ ì„œë¹„ìŠ¤ ì €ì¥
        currentUser.dropReason = document.getElementById('dropReason').value;
        currentUser.want1 = document.getElementById('wants1').value;

        document.getElementById('step-survey').classList.add('hidden');
        document.getElementById('step-scale').classList.remove('hidden');
        renderQuestions();
    }

    function renderQuestions() {
        const area = document.getElementById('question-area');
        area.innerHTML = "";
        
        // ê°„ë‹¨í•œ ì˜ˆì‹œë¡œ ìë¦½ + ì‹¬ë¦¬ ì¼ë¶€ë§Œ ë Œë”ë§ (ì‹¤ì œë¡  ì „ì²´ ë£¨í”„)
        // ì‹¤ì œ êµ¬í˜„ ì‹œ QUESTIONS ë°°ì—´ì„ ëª¨ë‘ ìˆœíšŒí•´ì•¼ í•¨.
        
        // ì˜ˆì‹œ ë¬¸í•­ ìƒì„±
        let qList = [...QUESTIONS.jarip, ...QUESTIONS.simni];
        
        qList.forEach((q, idx) => {
            const div = document.createElement('div');
            div.className = "card";
            div.innerHTML = `
                <p><strong>Q${idx+1}.</strong> ${q.t}</p>
                <div class="radio-group">
                    <label><input type="radio" name="q_${q.d}_${q.no}" value="1" onchange="saveAns('${q.d}', ${q.no}, 1, ${q.rev||false}, ${q.crit||false}, '${q.t}')">ì „í˜€<br>ì•„ë‹˜</label>
                    <label><input type="radio" name="q_${q.d}_${q.no}" value="2" onchange="saveAns('${q.d}', ${q.no}, 2, ${q.rev||false}, ${q.crit||false}, '${q.t}')">ì•„ë‹ˆë‹¤</label>
                    <label><input type="radio" name="q_${q.d}_${q.no}" value="3" onchange="saveAns('${q.d}', ${q.no}, 3, ${q.rev||false}, ${q.crit||false}, '${q.t}')">ë³´í†µ</label>
                    <label><input type="radio" name="q_${q.d}_${q.no}" value="4" onchange="saveAns('${q.d}', ${q.no}, 4, ${q.rev||false}, ${q.crit||false}, '${q.t}')">ê·¸ë ‡ë‹¤</label>
                    <label><input type="radio" name="q_${q.d}_${q.no}" value="5" onchange="saveAns('${q.d}', ${q.no}, 5, ${q.rev||false}, ${q.crit||false}, '${q.t}')">ë§¤ìš°<br>ê·¸ë ‡ë‹¤</label>
                </div>
            `;
            area.appendChild(div);
        });
    }

    function saveAns(domain, no, val, rev, crit, text) {
        answers[`${domain}_${no}`] = { val, rev, crit, text, domain };
    }

    async function submitData() {
        if(!confirm("ì œì¶œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;

        const dataToSave = {
            info: currentUser,
            ans: answers,
            timestamp: new Date().getTime()
        };

        if(db) {
            await db.collection("intake_results").add(dataToSave);
            alert("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
        } else {
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì‚¬ìš© (Firebase ì—†ì„ ë•Œ)
            let localData = JSON.parse(localStorage.getItem("dream_intake") || "[]");
            localData.push(dataToSave);
            localStorage.setItem("dream_intake", JSON.stringify(localData));
            alert("ê¸°ê¸°ì— ì„ì‹œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
        }

        document.getElementById('step-scale').classList.add('hidden');
        document.getElementById('step-end').classList.remove('hidden');
    }

    // ============================================================
    // 3. ê´€ë¦¬ì ê¸°ëŠ¥ (ì¸ì‡„ ë° ì¡°íšŒ)
    // ============================================================
    function showAdminLogin() {
        document.getElementById('youth-view').classList.add('hidden');
        document.getElementById('admin-view').classList.remove('hidden');
    }

    function verifyAdmin() {
        if(document.getElementById('adminPw').value === "1388") {
            document.getElementById('admin-login').classList.add('hidden');
            document.getElementById('admin-dashboard').classList.remove('hidden');
            loadList();
        } else {
            alert("ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜");
        }
    }

    async function loadList() {
        const list = document.getElementById('user-list');
        list.innerHTML = "";
        
        let data = [];
        if(db) {
            const snapshot = await db.collection("intake_results").orderBy("timestamp", "desc").get();
            snapshot.forEach(doc => data.push(doc.data()));
        } else {
            data = JSON.parse(localStorage.getItem("dream_intake") || "[]");
        }

        data.forEach((d, idx) => {
            const li = document.createElement('li');
            li.innerHTML = `
                <div class="card" style="display:flex; justify-content:space-between; align-items:center;">
                    <div><strong>${d.info.name}</strong> (${d.info.date})</div>
                    <button class="btn" style="width:auto; margin:0; padding:10px;" onclick='viewReport(${JSON.stringify(d)})'>ê²°ê³¼ë³´ê¸°</button>
                </div>
            `;
            list.appendChild(li);
        });
    }

    function viewReport(data) {
        document.getElementById('admin-dashboard').classList.add('hidden');
        document.getElementById('report-area').classList.remove('hidden');

        // 1. ê¸°ë³¸ ì •ë³´ ë§¤í•‘
        document.getElementById('r-name').innerText = data.info.name;
        document.getElementById('r-birth').innerText = data.info.birth;
        document.getElementById('r-date').innerText = data.info.date;
        document.getElementById('r-reason').innerText = data.info.dropReason;
        document.getElementById('r-want').innerText = data.info.want1;

        // 2. ì ìˆ˜ ê³„ì‚° (ë§¤ë‰´ì–¼ ë¡œì§ ì ìš©)
        let scores = {};
        let redFlags = [];
        let rawHtml = "";

        for(let key in data.ans) {
            const item = data.ans[key];
            let score = item.val;
            
            // ì—­ì±„ì  ë¡œì§ [cite: 1335]
            if(item.rev) score = 6 - item.val;

            // ì ìˆ˜ í•©ì‚°
            if(!scores[item.domain]) scores[item.domain] = 0;
            scores[item.domain] += score;

            // Red Flag ê°ì§€ (ìì‚´, ìí•´ ë“±) [cite: 1324]
            if(item.crit && item.val >= 3) {
                redFlags.push(`[${item.domain}] ${item.text} (ì‘ë‹µ: ${item.val})`);
            }

            rawHtml += `<span>Q.${item.domain}: ${item.val}ì </span><br>`;
        }

        // 3. ìë¦½ì—­ëŸ‰ ê²°ê³¼ ë Œë”ë§
        // ì˜ˆì‹œ ê¸°ì¤€ì ìˆ˜ (ë§¤ë‰´ì–¼ í‘œ ì°¸ì¡°) [cite: 107]
        const JARIP_CUTOFF = { 'ìì¡´ê°': 19, 'ì„±ì‹¤ì„±': 15, 'í•™ì—…íš¨ëŠ¥ê°': 13 }; 
        let jaripHtml = "";
        for(let d in JARIP_CUTOFF) {
            let s = scores[d] || 0;
            let risk = s <= JARIP_CUTOFF[d] ? "<span class='danger-text'>ìœ„í—˜êµ° (ë‚®ìŒ)</span>" : "ì¼ë°˜êµ°";
            jaripHtml += `<tr><td>${d}</td><td>${s}</td><td>${JARIP_CUTOFF[d]}ì  ì´í•˜</td><td>${risk}</td></tr>`;
        }
        document.getElementById('r-jarip-body').innerHTML = jaripHtml;

        // 4. ì‹¬ë¦¬ì •ì„œ ê²°ê³¼ ë Œë”ë§
        // ì˜ˆì‹œ ê¸°ì¤€ì ìˆ˜ (ë§¤ë‰´ì–¼ í‘œ ì°¸ì¡°) [cite: 181]
        const SIMNI_CUTOFF = { 'ìš°ìš¸Â·ë¶ˆì•ˆ': 42, 'ìì‚´': 9 }; // ìì‚´ì€ 9ì  ì´ìƒì´ì§€ë§Œ ê°œë³„ ë¬¸í•­ ì¤‘ìš”
        let simniHtml = "";
        for(let d in SIMNI_CUTOFF) {
            let s = scores[d] || 0;
            let risk = s >= SIMNI_CUTOFF[d] ? "<span class='danger-text'>ìœ„í—˜êµ° (ë†’ìŒ)</span>" : "ì¼ë°˜êµ°";
            simniHtml += `<tr><td>${d}</td><td>${s}</td><td>${SIMNI_CUTOFF[d]}ì  ì´ìƒ</td><td>${risk}</td></tr>`;
        }
        document.getElementById('r-simni-body').innerHTML = simniHtml;

        // 5. ê°€ì´ë“œ ì¶œë ¥
        let guideHtml = "<ul>";
        if(redFlags.length > 0) {
            redFlags.forEach(msg => guideHtml += `<li class='danger-text'>${msg} -> ì¶”ê°€ íƒìƒ‰ í•„ìš”</li>`);
            guideHtml += "<li><strong>(ê°€ì´ë“œ)</strong> ìì‚´/ìí•´ ë¬¸í•­ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ë§¤ë‰´ì–¼ 58pì— ë”°ë¼ êµ¬ì²´ì ì¸ ê³„íš ì—¬ë¶€ë¥¼ ë¬¼ì–´ë³´ì‹­ì‹œì˜¤. [cite: 680]</li>";
        } else {
            guideHtml += "<li>íŠ¹ì´ì‚¬í•­ ì—†ìŒ.</li>";
        }
        guideHtml += "</ul>";
        document.getElementById('r-guide').innerHTML = guideHtml;
        document.getElementById('r-raw-data').innerHTML = rawHtml;
    }

    function closeReport() {
        document.getElementById('report-area').classList.add('hidden');
        document.getElementById('admin-dashboard').classList.remove('hidden');
    }
</script>
</body>
</html>