<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë…¸ì›êµ¬ ê¿ˆë“œë¦¼ í¬ë§ì„œë¹„ìŠ¤ ì¡°ì‚¬í‘œ</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <script src="scales.js"></script>
    
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        :root { --primary: #FF7F50; --bg: #FFF9F5; --card: #FFFFFF; --text: #333; --danger: #FF4B4B; --gray: #888; }
        
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; padding-bottom: 90px; -webkit-tap-highlight-color: transparent; }
        
        /* í—¤ë” & ì§„í–‰ë°” */
        .header { position: fixed; top: 0; width: 100%; height: 55px; background: white; z-index: 100; display: flex; align-items: center; padding: 0 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); justify-content: space-between; }
        .logo { font-weight: 800; font-size: 1.1rem; color: var(--primary); }
        .progress-container { position: fixed; top: 55px; left: 0; width: 100%; height: 6px; background: #eee; z-index: 99; }
        .progress-bar { height: 100%; background: var(--primary); width: 0%; transition: width 0.4s ease; }

        .container { max-width: 800px; margin: 90px auto 0; padding: 20px; }
        .card { background: var(--card); border-radius: 16px; padding: 25px; margin-bottom: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.03); border: 1px solid #f0f0f0; }
        
        h2 { font-size: 1.3rem; margin-top: 0; padding-bottom: 10px; border-bottom: 2px solid var(--primary); color: #222; }
        h3 { background: #f8f8f8; padding: 10px 15px; border-radius: 8px; font-size: 1.05rem; margin-top: 30px; margin-bottom: 15px; color: #444; }

        /* ì…ë ¥ í¼ */
        .form-group { margin-bottom: 25px; }
        label { display: block; font-weight: 700; margin-bottom: 8px; font-size: 1rem; color: #444; }
        .req { color: var(--danger); margin-left: 3px; } /* í•„ìˆ˜ í‘œì‹œ */
        .sub-desc { font-weight: normal; font-size: 0.85rem; color: var(--gray); margin-left: 5px; }

        input[type="text"], input[type="tel"], input[type="date"], input[type="number"], input[type="email"], select {
            width: 100%; padding: 14px; border: 1px solid #ddd; border-radius: 12px; font-size: 1rem; box-sizing: border-box; background: #fff;
        }
        input:focus, select:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 3px rgba(255, 127, 80, 0.1); }

        /* ë²„íŠ¼í˜• ì„ íƒì§€ (ë¼ë””ì˜¤/ì²´í¬ë°•ìŠ¤) */
        .btn-group { display: flex; flex-wrap: wrap; gap: 8px; }
        .btn-group label {
            flex: 1; min-width: 90px; text-align: center; padding: 12px; border: 1px solid #ddd; border-radius: 10px; 
            background: #fff; cursor: pointer; font-weight: 500; transition: 0.2s; display: flex; align-items: center; justify-content: center;
        }
        .btn-group input { display: none; }
        .btn-group label:has(input:checked) { background: #FFF0EB; border-color: var(--primary); color: var(--primary); font-weight: 800; box-shadow: 0 0 0 1px var(--primary); }

        /* í•˜ë‹¨ ë²„íŠ¼ë°” */
        .bottom-bar { position: fixed; bottom: 0; left: 0; width: 100%; padding: 15px; background: white; border-top: 1px solid #eee; display: flex; gap: 10px; box-sizing: border-box; z-index: 100; }
        .btn { flex: 1; padding: 15px; border-radius: 12px; border: none; font-size: 1.1rem; font-weight: bold; cursor: pointer; }
        .btn-prev { background: #f0f0f0; color: #555; flex: 0.8; }
        .btn-save { background: #333; color: white; flex: 0.6; font-size: 1rem; }
        .btn-next { background: var(--primary); color: white; flex: 2; }

        .hidden { display: none !important; }
        
        /* ê°€ì¡±ê´€ê³„ í…Œì´ë¸”í˜• */
        .fam-row { display: grid; grid-template-columns: 0.8fr 1fr 0.6fr 1fr 0.6fr; gap: 5px; margin-bottom: 8px; }
        .fam-row input, .fam-row select { padding: 8px; font-size: 0.9rem; }
        
        /* ì²™ë„ ë¬¸í•­ */
        .q-card { background: #fff; border: 1px solid #eee; border-radius: 15px; padding: 20px; margin-bottom: 15px; }
        .q-text { font-weight: bold; font-size: 1.15rem; margin-bottom: 15px; word-break: keep-all; }

        /* ì¸ì‡„ */
        @media print {
            .no-print, .bottom-bar, .header, .progress-container { display: none !important; }
            #report-area { display: block !important; }
            body { background: white; padding: 0; }
            .card { box-shadow: none; border: none; padding: 0; margin: 0; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 10px; font-size: 10pt; }
            th, td { border: 1px solid #000; padding: 5px; text-align: center; font-size: 10pt; }
            th { background: #f0f0f0; width: 15%; }
            td.text-left { text-align: left; padding-left: 5px; }
            .section-head { font-size: 12pt; font-weight: bold; border-bottom: 2px solid #000; margin: 15px 0 5px 0; }
            .page-break { page-break-before: always; }
        }
    </style>
</head>
<body>

<div class="header no-print">
    <div class="logo">ë…¸ì›êµ¬ ê¿ˆë“œë¦¼</div>
    <div style="font-size:0.9rem; color:#888; cursor:pointer;" onclick="showAdmin()">ê´€ë¦¬ì</div>
</div>
<div class="progress-container no-print"><div class="progress-bar" id="progressBar"></div></div>

<div id="step-intro" class="container" style="text-align:center; padding-top:80px;">
    <div class="card">
        <h1 style="color:var(--primary); font-size:2rem; margin-bottom:10px;">í¬ë§ ì„œë¹„ìŠ¤ ì¡°ì‚¬í‘œ</h1>
        <p style="color:#666; margin-bottom:40px; line-height:1.6;">
            ì•ˆë…•í•˜ì„¸ìš”.<br>ê¿ˆë“œë¦¼ ì„¼í„°ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤.<br>
            ì—¬ëŸ¬ë¶„ì„ ë•ê¸° ìœ„í•œ ê¸°ì´ˆ ìë£Œì´ì˜¤ë‹ˆ<br>
            <strong>ë¹ ì§ì—†ì´ ì†”ì§í•˜ê²Œ</strong> ì‘ì„±í•´ ì£¼ì„¸ìš”.
        </p>
        <button class="btn btn-next" style="width:100%;" onclick="startSurvey()">ì‹œì‘í•˜ê¸°</button>
    </div>
</div>

<div id="survey-container" class="container hidden">
    
    <div id="page-1" class="wizard-page">
        <div class="card">
            <h2>1. ê¸°ë³¸ ì¸ì ì‚¬í•­</h2>
            
            <div class="form-group">
                <label>ì‘ì„±ì¼</label>
                <input type="text" id="todayDate" readonly style="background:#f9f9f9; color:#666;">
            </div>

            <div class="form-group">
                <label>ì„±ëª… <span class="req">*</span></label>
                <input type="text" id="userName" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
            </div>

            <div class="form-group">
                <label>ì„±ë³„ <span class="req">*</span></label>
                <div class="btn-group">
                    <label><input type="radio" name="gender" value="ë‚¨">ë‚¨ì</label>
                    <label><input type="radio" name="gender" value="ì—¬">ì—¬ì</label>
                </div>
            </div>

            <div class="form-group">
                <label>ìƒë…„ì›”ì¼ <span class="req">*</span></label>
                <input type="date" id="userBirth">
            </div>

            <div class="form-group">
                <label>ì—°ë½ì²˜ (ë³¸ì¸) <span class="req">*</span></label>
                <input type="tel" id="telSelf" placeholder="ìˆ«ìë§Œ ì…ë ¥ (ì˜ˆ: 01012345678)" maxlength="11" oninput="this.value = this.value.replace(/[^0-9]/g, '')">
            </div>

            <div class="form-group">
                <label>ì£¼ì†Œ <span class="req">*</span></label>
                <input type="text" id="address" placeholder="ì‹œ/êµ¬/ë™ ê¹Œì§€ ì…ë ¥">
            </div>

            <div class="form-group">
                <label>ì—°ë½ì²˜ (ë³´í˜¸ì) <span class="req">*</span></label>
                <input type="tel" id="telParent" placeholder="ìˆ«ìë§Œ ì…ë ¥" maxlength="11" oninput="this.value = this.value.replace(/[^0-9]/g, '')">
            </div>

            <div class="form-group">
                <label>ì´ë©”ì¼</label>
                <input type="email" id="email" placeholder="example@naver.com">
            </div>

            <div class="form-group">
                <label>ë©”ì‹ ì € ID (ì¹´í†¡ ë“±)</label>
                <input type="text" id="messengerId">
            </div>

            <div class="form-group">
                <label>í˜„ì¬ ì²­ì†Œë…„ ìƒíƒœ <span class="req">*</span></label>
                <div class="btn-group" style="flex-direction:column;">
                    <label><input type="radio" name="status" value="í•™êµ ë°– ì²­ì†Œë…„">í•™êµ ë°– ì²­ì†Œë…„ (ìí‡´, ë¯¸ì§„í•™, ì œì )</label>
                    <label><input type="radio" name="status" value="ê³ ì¡¸ê²€ì •ê³ ì‹œí•©ê²©">ê³ ì¡¸ ê²€ì •ê³ ì‹œ í•©ê²© ì²­ì†Œë…„</label>
                    <label><input type="radio" name="status" value="í•™ì—…ì¤‘ë‹¨ìˆ™ë ¤ì œ">í•™ì—…ì¤‘ë‹¨ ìˆ™ë ¤ì œ ìƒë‹´ ì°¸ì—¬ ì¤‘</label>
                </div>
            </div>
        </div>
    </div>

    <div id="page-2" class="wizard-page hidden">
        <div class="card">
            <h2>2. í•™ì—… ì¤‘ë‹¨ ë° ë°°ê²½</h2>
            
            <div class="form-group">
                <label>ì–¸ì œê¹Œì§€ í•™êµì— ë‹¤ë…”ë‚˜ìš”? (í•™êµê¸‰) <span class="req">*</span></label>
                <div class="btn-group">
                    <label><input type="radio" name="schLvl" value="ì´ˆë“±í•™êµ" onclick="showGrades(6)">ì´ˆë“±í•™êµ</label>
                    <label><input type="radio" name="schLvl" value="ì¤‘í•™êµ" onclick="showGrades(3)">ì¤‘í•™êµ</label>
                    <label><input type="radio" name="schLvl" value="ê³ ë“±í•™êµ" onclick="showGrades(3)">ê³ ë“±í•™êµ</label>
                    <label><input type="radio" name="schLvl" value="ë¯¸ì§„í•™" onclick="showGrades(0)">ë¯¸ì§„í•™ (ì•ˆë‹¤ë‹˜)</label>
                </div>
            </div>

            <div class="form-group hidden" id="grade-section">
                <label>ë‹¤ë…”ë˜ í•™ë…„ (ë˜ëŠ” í•™ê¸°)</label>
                <div id="grade-btns" class="btn-group"></div>
                <div class="btn-group" style="margin-top:5px;">
                    <label><input type="radio" name="semester" value="1í•™ê¸°">1í•™ê¸°</label>
                    <label><input type="radio" name="semester" value="2í•™ê¸°">2í•™ê¸°</label>
                    <label><input type="radio" name="semester" value="ìˆ˜ë£Œ">ìˆ˜ë£Œ/ì¡¸ì—…</label>
                </div>
            </div>

            <div class="form-group">
                <label>í•™êµë¥¼ ê·¸ë§Œë‘” ë‚ ì§œ <span class="req">*</span></label>
                <div style="display:flex; gap:5px;">
                    <input type="number" id="dropY" placeholder="ë…„(20XX)" style="flex:1;">
                    <input type="number" id="dropM" placeholder="ì›”" style="flex:0.5;">
                    <input type="number" id="dropD" placeholder="ì¼" style="flex:0.5;">
                </div>
                <p class="sub-desc">â€» ì •í™•í•œ ë‚ ì§œë¥¼ ëª¨ë¥´ë©´ ëŒ€ëµì ìœ¼ë¡œ ì ì–´ì£¼ì„¸ìš”.</p>
            </div>

            <div class="form-group">
                <label>í•™êµë¥¼ ê·¸ë§Œë‘” ì´ìœ  (1ìˆœìœ„) <span class="req">*</span></label>
                <select id="reason1" onchange="updateReasonOptions()">
                    <option value="">ì„ íƒí•´ì£¼ì„¸ìš” (í•„ìˆ˜)</option>
                </select>
            </div>
            <div class="form-group">
                <label>í•™êµë¥¼ ê·¸ë§Œë‘” ì´ìœ  (2ìˆœìœ„)</label>
                <select id="reason2" onchange="updateReasonOptions()">
                    <option value="">ì„ íƒ (ì—†ìœ¼ë©´ ë¹„ì›Œë‘ì„¸ìš”)</option>
                </select>
            </div>
            <div class="form-group">
                <label>í•™êµë¥¼ ê·¸ë§Œë‘” ì´ìœ  (3ìˆœìœ„)</label>
                <select id="reason3">
                    <option value="">ì„ íƒ (ì—†ìœ¼ë©´ ë¹„ì›Œë‘ì„¸ìš”)</option>
                </select>
            </div>
            <input type="text" id="reasonEtc" class="hidden" placeholder="ê¸°íƒ€ ì‚¬ìœ ë¥¼ êµ¬ì²´ì ìœ¼ë¡œ ì ì–´ì£¼ì„¸ìš”" style="margin-top:5px;">

            <div class="form-group">
                <label>ê·¸ë§Œë‘˜ ë‹¹ì‹œ ë¶€ëª¨ë‹˜(ë³´í˜¸ì) ì˜ê²¬ <span class="req">*</span></label>
                <div class="btn-group">
                    <label><input type="radio" name="parentAgree" value="ë™ì˜">ë™ì˜í•˜ì…¨ìŒ</label>
                    <label><input type="radio" name="parentAgree" value="ë°˜ëŒ€">ë°˜ëŒ€í•˜ì…¨ìŒ</label>
                    <label><input type="radio" name="parentAgree" value="ë¬´ê´€ì‹¬">ë³„ ê´€ì‹¬ ì—†ìœ¼ì…¨ìŒ</label>
                    <label><input type="radio" name="parentAgree" value="ì˜ëª¨ë¦„">ì˜ ëª¨ë¦„</label>
                    <label><input type="radio" name="parentAgree" value="ê¸°íƒ€">ê¸°íƒ€</label>
                </div>
            </div>
        </div>
    </div>

    <div id="page-3" class="wizard-page hidden">
        <div class="card">
            <h2>3. ê¿ˆë“œë¦¼ ì„¼í„° ë°©ë¬¸ ê²½ë¡œ <span class="req">*</span></h2>
            <div class="btn-group" style="flex-direction:column;">
                <label><input type="radio" name="visitPath" value="ì¹œêµ¬/ì„ ë°°">ì¹œêµ¬, ì„ ë°°ì˜ ì†Œê°œ</label>
                <label><input type="radio" name="visitPath" value="ê°€ì¡±">ë¶€ëª¨ë‹˜, í˜•ì œ ë“± ê°€ì¡±ì˜ ê¶Œìœ </label>
                <label><input type="radio" name="visitPath" value="í•™êµ">í•™êµ ì„ ìƒë‹˜ì˜ ì•ˆë‚´</label>
                <label><input type="radio" name="visitPath" value="ì¸í„°ë„·">ì¸í„°ë„· ê²€ìƒ‰ (ë„¤ì´ë²„, SNS ë“±)</label>
                <label><input type="radio" name="visitPath" value="ê²½ì°°">ê²½ì°°ì„œ, ë³´í˜¸ê´€ì°°ì†Œ ì—°ê³„</label>
                <label><input type="radio" name="visitPath" value="í˜„ìˆ˜ë§‰">ê¸¸ê±°ë¦¬ í™ë³´, í˜„ìˆ˜ë§‰</label>
                <label><input type="radio" name="visitPath" value="ê¸°íƒ€">ê¸°íƒ€</label>
            </div>
        </div>
    </div>

    <div id="page-4" class="wizard-page hidden">
        <div class="card">
            <h2>4. ê°€ì¡± ë° ê²½ì œ ìƒí™©</h2>
            
            <div class="form-group">
                <label>ê°€ì¡± êµ¬ì„±ì› (ìµœëŒ€ 5ëª…)</label>
                <div style="display:grid; grid-template-columns:0.8fr 1fr 0.6fr 1fr 0.6fr; gap:5px; text-align:center; font-size:0.85rem; font-weight:bold; color:#666; margin-bottom:5px;">
                    <span>ê´€ê³„</span><span>ì´ë¦„</span><span>ë‚˜ì´</span><span>ì—°ë½ì²˜</span><span>ë™ê±°</span>
                </div>
                <div id="family-rows"></div>
            </div>

            <div class="form-group">
                <label>í˜„ì¬ ê°€ì • í˜•íƒœ <span class="req">*</span></label>
                <div class="btn-group">
                    <label><input type="radio" name="famType" value="ì¹œë¶€ëª¨">ì¹œë¶€ëª¨</label>
                    <label><input type="radio" name="famType" value="í•œë¶€ëª¨(ë¶€)">í•œë¶€ëª¨(ë¶€)</label>
                    <label><input type="radio" name="famType" value="í•œë¶€ëª¨(ëª¨)">í•œë¶€ëª¨(ëª¨)</label>
                    <label><input type="radio" name="famType" value="ì¡°ì†">ì¡°ì†</label>
                    <label><input type="radio" name="famType" value="ì¬í˜¼">ì¬í˜¼</label>
                    <label><input type="radio" name="famType" value="ì†Œë…„ì†Œë…€ê°€ì¥">ì²­ì†Œë…„ê°€ì¥</label>
                    <label><input type="radio" name="famType" value="ì‹œì„¤">ì‹œì„¤/ì‰¼í„°</label>
                    <label><input type="radio" name="famType" value="ì¹œì¸ì²™">ì¹œì¸ì²™</label>
                    <label><input type="radio" name="famType" value="ê¸°íƒ€">ê¸°íƒ€</label>
                </div>
            </div>

            <div class="form-group">
                <label>ê°€ì •ì˜ ê²½ì œ ìƒíƒœ <span class="req">*</span></label>
                <div class="btn-group">
                    <label><input type="radio" name="econ" value="ìƒ">ì—¬ìœ  ìˆë‹¤</label>
                    <label><input type="radio" name="econ" value="ì¤‘">ë³´í†µì´ë‹¤</label>
                    <label><input type="radio" name="econ" value="í•˜">ì–´ë µë‹¤</label>
                    <label><input type="radio" name="econ" value="ê¸°ì´ˆìˆ˜ê¸‰">ê¸°ì´ˆìˆ˜ê¸‰</label>
                    <label><input type="radio" name="econ" value="ì°¨ìƒìœ„">ì°¨ìƒìœ„</label>
                </div>
            </div>

            <div class="form-group">
                <label>ìš©ëˆ ë§Œì¡±ë„</label>
                <div class="btn-group">
                    <label><input type="radio" name="moneySat" value="ì¶©ë¶„">ì¶©ë¶„í•¨</label>
                    <label><input type="radio" name="moneySat" value="ë³´í†µ">ë³´í†µ</label>
                    <label><input type="radio" name="moneySat" value="ë¶€ì¡±">ë¶€ì¡±í•¨</label>
                    <label><input type="radio" name="moneySat" value="ì—†ìŒ">ì•ˆ ë°›ìŒ</label>
                </div>
            </div>

            <div class="form-group">
                <label>ê°€ì¡±ì˜ ê´€ì‹¬ ì •ë„</label>
                <div class="btn-group">
                    <label><input type="radio" name="famInterest" value="ë§¤ìš°ë§ìŒ">ë§¤ìš° ë§ìŒ</label>
                    <label><input type="radio" name="famInterest" value="ì•½ê°„ìˆìŒ">ì•½ê°„ ìˆìŒ</label>
                    <label><input type="radio" name="famInterest" value="ë³´í†µ">ë³´í†µ</label>
                    <label><input type="radio" name="famInterest" value="ë³„ë¡œì—†ìŒ">ë³„ë¡œ ì—†ìŒ</label>
                    <label><input type="radio" name="famInterest" value="ì „í˜€ì—†ìŒ">ì „í˜€ ì—†ìŒ</label>
                </div>
            </div>

            <div class="form-group">
                <label>ê³ ë¯¼ì„ ì´ì•¼ê¸°í•˜ëŠ” ëŒ€ìƒ</label>
                <div class="btn-group">
                    <label><input type="radio" name="confidant" value="ë¶€ëª¨">ë¶€ëª¨ë‹˜</label>
                    <label><input type="radio" name="confidant" value="í˜•ì œìë§¤">í˜•ì œìë§¤</label>
                    <label><input type="radio" name="confidant" value="ì¹œêµ¬">ì¹œêµ¬</label>
                    <label><input type="radio" name="confidant" value="ì„ ìƒë‹˜">ì„ ìƒë‹˜</label>
                    <label><input type="radio" name="confidant" value="ì—†ìŒ">ì—†ìŒ</label>
                </div>
            </div>
        </div>
    </div>

    <div id="page-5" class="wizard-page hidden">
        <div class="card">
            <h2>5. ì–´ë ¤ì›€ ë° ìš•êµ¬</h2>
            
            <label>í˜„ì¬ ê²ªê³  ìˆëŠ” ì–´ë ¤ì›€ (í•´ë‹¹ì‚¬í•­ ëª¨ë‘ ì²´í¬)</label>
            
            <h3>ğŸ˜Ÿ ê°œì¸ì  ì–´ë ¤ì›€</h3>
            <div class="btn-group">
                <label><input type="checkbox" name="diff" value="ì„±ê²©">ì„±ê²©/ì •ì„œ</label>
                <label><input type="checkbox" name="diff" value="ê±´ê°•">ì‹ ì²´ê±´ê°•</label>
                <label><input type="checkbox" name="diff" value="ìƒí™œìŠµê´€">ë¶ˆê·œì¹™ ìƒí™œ</label>
                <label><input type="checkbox" name="diff" value="ì¥ì• ">ì¥ì• </label>
            </div>

            <h3>ğŸ  ê°€ì • ë° í™˜ê²½</h3>
            <div class="btn-group">
                <label><input type="checkbox" name="diff" value="ê°€ì¡±ê°ˆë“±">ê°€ì¡±ê°ˆë“±</label>
                <label><input type="checkbox" name="diff" value="ê²½ì œ">ê²½ì œì  ì–´ë ¤ì›€</label>
                <label><input type="checkbox" name="diff" value="ë¶€ëª¨ë°©ì„">ë¶€ëª¨ ë¬´ê´€ì‹¬</label>
            </div>

            <h3>ğŸ« í•™êµ ë° ì‚¬íšŒ</h3>
            <div class="btn-group">
                <label><input type="checkbox" name="diff" value="í•™ì—…">í•™ì—…ë¶€ì§„</label>
                <label><input type="checkbox" name="diff" value="ì§„ë¡œ">ì§„ë¡œ ë¯¸ê²°ì •</label>
                <label><input type="checkbox" name="diff" value="ì¹œêµ¬">ì¹œêµ¬ê´€ê³„</label>
                <label><input type="checkbox" name="diff" value="ë”°ëŒë¦¼">ë”°ëŒë¦¼</label>
            </div>

            <h3>ğŸ® í–‰ë™ ë° ê¸°íƒ€</h3>
            <div class="btn-group">
                <label><input type="checkbox" name="diff" value="ìŠ¤ë§ˆíŠ¸í°">ìŠ¤ë§ˆíŠ¸í°</label>
                <label><input type="checkbox" name="diff" value="ë¹„í–‰">ë¹„í–‰/ì¼íƒˆ</label>
                <label><input type="checkbox" name="diff" value="ë²•ë¥ ">ë²•ì  ë¬¸ì œ</label>
                <label><input type="checkbox" name="diff" value="ì„±">ì„± ê´€ë ¨</label>
            </div>

            <h3 style="background:white; padding:0; margin-top:40px;">í•™êµ ì¤‘ë‹¨ í›„ ëª©í‘œ <span class="req">*</span></h3>
            <div class="btn-group">
                <label><input type="radio" name="goal" value="ê²€ì •ê³ ì‹œ">ê²€ì •ê³ ì‹œ</label>
                <label><input type="radio" name="goal" value="ë³µí•™">ë³µí•™</label>
                <label><input type="radio" name="goal" value="ì§„í•™">ìƒê¸‰í•™êµ ì§„í•™</label>
                <label><input type="radio" name="goal" value="ì·¨ì—…">ì·¨ì—…/ì•Œë°”</label>
                <label><input type="radio" name="goal" value="ìê²©ì¦">ìê²©ì¦</label>
                <label><input type="radio" name="goal" value="ë¯¸ì •">ì•„ì§ ëª¨ë¦„</label>
            </div>

            <h3 style="background:white; padding:0; margin-top:40px;">í¬ë§ ì„œë¹„ìŠ¤ (ì¤‘ë³µ ê°€ëŠ¥)</h3>
            <div class="btn-group">
                <label><input type="checkbox" name="service" value="ìƒë‹´">ì‹¬ë¦¬ìƒë‹´</label>
                <label><input type="checkbox" name="service" value="êµìœ¡">í•™ì—…(ê²€ì •ê³ ì‹œ)</label>
                <label><input type="checkbox" name="service" value="ìë¦½">ìë¦½(ìê²©ì¦)</label>
                <label><input type="checkbox" name="service" value="ë¬¸í™”">ë¬¸í™”ì²´í—˜</label>
                <label><input type="checkbox" name="service" value="ê±´ê°•">ê±´ê°•ê²€ì§„</label>
                <label><input type="checkbox" name="service" value="ìƒí™œ">ê¸‰ì‹/êµí†µë¹„</label>
                <label><input type="checkbox" name="service" value="ë©˜í† ë§">ë©˜í† ë§</label>
            </div>

            <h3 style="background:white; padding:0; margin-top:40px;">ê³¼ê±° í•™êµìƒí™œ ë° ê±´ê°•</h3>
            <div class="form-group">
                <label>ê³¼ê±° í•™êµìƒí™œ ë§Œì¡±ë„</label>
                <div class="btn-group">
                    <label><input type="radio" name="pastSchool" value="ë§Œì¡±">ë§Œì¡±</label>
                    <label><input type="radio" name="pastSchool" value="ë³´í†µ">ë³´í†µ</label>
                    <label><input type="radio" name="pastSchool" value="ë¶ˆë§Œì¡±">ë¶ˆë§Œì¡±</label>
                </div>
            </div>
            <div class="form-group">
                <label>í˜„ì¬ ê±´ê°• ìƒíƒœ</label>
                <div class="btn-group">
                    <label><input type="radio" name="health" value="ì¢‹ìŒ">ê±´ê°•í•¨</label>
                    <label><input type="radio" name="health" value="ë³´í†µ">ë³´í†µ</label>
                    <label><input type="radio" name="health" value="ë‚˜ì¨">ë‚˜ì¨(ì¹˜ë£Œì¤‘)</label>
                </div>
            </div>
        </div>
    </div>

    <div id="page-6" class="wizard-page hidden">
        <div class="card">
            <h2>6. ìë¦½ì—­ëŸ‰ ì²™ë„</h2>
            <p class="sub-desc" style="text-align:center; margin-bottom:20px;">ê° ë¬¸í•­ì„ ì½ê³  ìì‹ ì—ê²Œ í•´ë‹¹ë˜ëŠ” ê²ƒì— ì²´í¬í•´ì£¼ì„¸ìš”.</p>
            <div id="jarip-area"></div>
        </div>
    </div>

    <div id="page-7" class="wizard-page hidden">
        <div class="card">
            <h2>7. ì‹¬ë¦¬ì •ì„œ ì²™ë„</h2>
            <p class="sub-desc" style="text-align:center; margin-bottom:20px;">ì†”ì§í•œ ë‹µë³€ì´ í° ë„ì›€ì´ ë©ë‹ˆë‹¤.</p>
            <div id="simni-area"></div>
        </div>
    </div>

    <div id="page-end" class="wizard-page hidden text-center" style="text-align:center; padding-top:50px;">
        <h1 style="font-size:3rem;">ğŸ‰</h1>
        <h2>ì‘ì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</h2>
        <p style="color:#666;">ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤.<br>ìƒë‹´ ì„ ìƒë‹˜ê»˜ íƒœë¸”ë¦¿ì„ ë“œë ¤ì£¼ì„¸ìš”.</p>
        <button class="btn btn-save" onclick="location.reload()" style="margin-top:20px; width:auto; padding:15px 30px;">ì²˜ìŒìœ¼ë¡œ</button>
    </div>

</div>

<div id="bottom-bar" class="bottom-bar hidden no-print">
    <button class="btn btn-prev" onclick="movePage(-1)">ì´ì „</button>
    <button class="btn btn-save" onclick="saveDraft()">ì„ì‹œì €ì¥</button>
    <button class="btn btn-next" onclick="movePage(1)" id="btn-next">ë‹¤ìŒ</button>
</div>

<div id="admin-view" class="container hidden no-print">
    <div class="card">
        <h2>ğŸ”’ ê´€ë¦¬ì ì ‘ì†</h2>
        <input type="password" id="adminPw" placeholder="ë¹„ë°€ë²ˆí˜¸ (1388)">
        <button class="btn btn-next" style="width:100%; margin-top:15px;" onclick="loginAdmin()">í™•ì¸</button>
        <button class="btn btn-prev" style="width:100%; margin-top:10px;" onclick="location.reload()">ë‚˜ê°€ê¸°</button>
    </div>
</div>

<div id="admin-list" class="container hidden no-print">
    <div class="card">
        <h2>ğŸ“‹ ì°¸ì—¬ì ëª©ë¡</h2>
        <ul id="list-area" style="list-style:none; padding:0;"></ul>
        <button class="btn btn-prev" style="width:100%;" onclick="location.reload()">ë‚˜ê°€ê¸°</button>
    </div>
</div>

<div id="report-area" class="hidden">
    <div style="text-align:center; border:2px solid #333; padding:15px; margin-bottom:20px;">
        <h1 style="margin:0; font-size:20pt; color:#000;">í•™êµ ë°– ì²­ì†Œë…„ ì´ˆê¸°ìƒë‹´ ê¸°ë¡ì§€</h1>
    </div>
    
    <div class="section-head">â… . ê¸°ë³¸ ì¸ì ì‚¬í•­</div>
    <table>
        <tr>
            <th width="15%">ì„±ëª…</th><td id="r-name"></td>
            <th width="15%">ìƒë…„ì›”ì¼</th><td id="r-birth"></td>
            <th width="10%">ì„±ë³„</th><td id="r-gender"></td>
        </tr>
        <tr>
            <th>ì£¼ì†Œ</th><td colspan="3" id="r-addr" class="text-left"></td>
            <th>ì‘ì„±ì¼</th><td id="r-today"></td>
        </tr>
        <tr>
            <th>ì—°ë½ì²˜(ë³¸ì¸)</th><td colspan="2" id="r-tel-s"></td>
            <th>ì—°ë½ì²˜(ë³´í˜¸ì)</th><td colspan="2" id="r-tel-p"></td>
        </tr>
        <tr>
            <th>ì´ë©”ì¼</th><td colspan="2" id="r-email"></td>
            <th>ë©”ì‹ ì €</th><td colspan="2" id="r-msg"></td>
        </tr>
        <tr>
            <th>í˜„ì¬ìƒíƒœ</th><td colspan="5" id="r-status"></td>
        </tr>
    </table>

    <div class="section-head">â…¡. í•™ì—… ì¤‘ë‹¨ ë° ë°°ê²½</div>
    <table>
        <tr>
            <th width="15%">ì¤‘ë‹¨ì‹œê¸°</th><td id="r-drop-when"></td>
            <th width="15%">ì¤‘ë‹¨ì¼ì</th><td id="r-drop-date"></td>
        </tr>
        <tr>
            <th>ì¤‘ë‹¨ì´ìœ (1)</th><td colspan="3" id="r-reason1" class="text-left"></td>
        </tr>
        <tr>
            <th>ë¶€ëª¨ì˜ê²¬</th><td id="r-agree"></td>
            <th>ë‚´ë°©ê²½ë¡œ</th><td id="r-path"></td>
        </tr>
    </table>

    <div class="section-head">â…¢. ê°€ì¡± ë° ê²½ì œ ìƒí™©</div>
    <table>
        <tr><th>ê°€ì¡±êµ¬ì„±</th><td colspan="3" id="r-family" class="text-left"></td></tr>
        <tr>
            <th>ê°€ì •í˜•íƒœ</th><td id="r-fam-type"></td>
            <th>ê²½ì œìˆ˜ì¤€</th><td id="r-econ"></td>
        </tr>
        <tr>
            <th>ìš©ëˆë§Œì¡±</th><td id="r-money"></td>
            <th>ê°€ì¡±ê´€ì‹¬</th><td id="r-interest"></td>
        </tr>
        <tr>
            <th>ê³ ë¯¼ì˜ë…¼</th><td colspan="3" id="r-talk"></td>
        </tr>
    </table>

    <div class="section-head">â…£. ì–´ë ¤ì›€ ë° ì„œë¹„ìŠ¤ ìš•êµ¬</div>
    <table>
        <tr><th>í˜¸ì†Œë¬¸ì œ</th><td colspan="3" id="r-diff" class="text-left"></td></tr>
        <tr>
            <th width="15%">í–¥í›„ëª©í‘œ</th><td id="r-goal"></td>
            <th width="15%">í¬ë§ì„œë¹„ìŠ¤</th><td id="r-service" class="text-left"></td>
        </tr>
        <tr>
            <th>ê±´ê°•ìƒíƒœ</th><td><span id="r-health"></span></td>
            <th>ê³¼ê±°í•™êµ</th><td><span id="r-school"></span></td>
        </tr>
    </table>

    <div class="section-head">â…¤. ì²™ë„ ê²€ì‚¬ ê²°ê³¼</div>
    <div style="display:flex; gap:10px;">
        <div style="flex:1">
            <table style="margin-bottom:5px;">
                <thead><tr><th colspan="3">ìë¦½ì—­ëŸ‰ (ì ìˆ˜â†“ ìœ„í—˜)</th></tr></thead>
                <tbody id="r-jarip-body"></tbody>
            </table>
        </div>
        <div style="flex:1">
            <table style="margin-bottom:5px;">
                <thead><tr><th colspan="3">ì‹¬ë¦¬ì •ì„œ (ì ìˆ˜â†‘ ìœ„í—˜)</th></tr></thead>
                <tbody id="r-simni-body"></tbody>
            </table>
        </div>
    </div>
    
    <div style="border:2px solid red; padding:10px; margin-top:10px;">
        <strong style="color:red;">ğŸš¨ ìœ„ê¸°(Red Flag) ë° í™•ì¸ì‚¬í•­</strong>
        <div id="r-redflag" style="font-size:10pt;"></div>
    </div>
</div>

<script>
    // [1] Firebase ì„¤ì • (ë³¸ì¸ í‚¤ë¡œ êµì²´ í•„ìˆ˜)
    const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "kdream-db462.firebaseapp.com",
        projectId: "kdream-db462",
        storageBucket: "kdream-db462.firebasestorage.app",
        messagingSenderId: "1020262030810",
        appId: "1:1020262030810:web:3482636bc020bb4310b4e3"
    };

    let db;
    try {
        firebase.initializeApp(firebaseConfig);
        db = firebase.firestore();
    } catch(e) { console.log("Firebase ë¡œì»¬ ëª¨ë“œ"); }

    // [2] ì „ì—­ ë³€ìˆ˜
    let currentPage = 0;
    const totalPages = 7;
    let formData = {};
    let answers = {};
    let scaleType = "YOUTH"; // YOUTH or CHILD

    window.onload = function() {
        document.getElementById('todayDate').value = new Date().toLocaleDateString();
        createFamilyInputs();
        fillReasonOptions();
        
        // ì„ì‹œì €ì¥ ë¶ˆëŸ¬ì˜¤ê¸°
        if(localStorage.getItem('kdream_temp')) {
            if(confirm('ì‘ì„± ì¤‘ì´ë˜ ë‚´ìš©ì´ ìˆìŠµë‹ˆë‹¤. ë¶ˆëŸ¬ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                // ì‹¤ì œ êµ¬í˜„ì‹œ ê°’ ë§¤í•‘ ë¡œì§ í•„ìš” (ì—¬ê¸°ì„  ìƒëµ)
            }
        }
    };

    function createFamilyInputs() {
        const div = document.getElementById('family-rows');
        for(let i=1; i<=5; i++) {
            div.innerHTML += `
                <div class="fam-row">
                    <input type="text" id="fr${i}">
                    <input type="text" id="fn${i}">
                    <input type="number" id="fa${i}">
                    <input type="tel" id="ft${i}">
                    <select id="fl${i}"><option value="Y">O</option><option value="N">X</option></select>
                </div>`;
        }
    }

    function fillReasonOptions() {
        const ids = ['reason1', 'reason2', 'reason3'];
        ids.forEach(id => {
            const el = document.getElementById(id);
            REASON_OPTIONS.forEach(opt => {
                let op = document.createElement('option');
                op.value = opt; op.text = opt;
                el.appendChild(op);
            });
        });
    }

    function updateReasonOptions() {
        const r1 = document.getElementById('reason1').value;
        const r2 = document.getElementById('reason2').value;
        const etc = document.getElementById('reasonEtc');
        
        // ê¸°íƒ€ ì…ë ¥ì°½
        if(r1 === 'ê¸°íƒ€' || r2 === 'ê¸°íƒ€') etc.classList.remove('hidden');
        else etc.classList.add('hidden');

        // ì¤‘ë³µ ë°©ì§€ ë¡œì§ (ê°„ë‹¨ êµ¬í˜„)
        const opts2 = document.getElementById('reason2').options;
        for(let i=0; i<opts2.length; i++) {
            opts2[i].disabled = (opts2[i].value !== "" && opts2[i].value === r1);
        }
    }

    function showGrades(cnt) {
        const area = document.getElementById('grade-section');
        const btns = document.getElementById('grade-btns');
        btns.innerHTML = "";
        
        if(cnt === 0) { area.classList.add('hidden'); return; }
        
        area.classList.remove('hidden');
        for(let i=1; i<=cnt; i++) {
            btns.innerHTML += `
                <label><input type="radio" name="grade" value="${i}í•™ë…„">${i}í•™ë…„</label>
            `;
        }
    }

    function startSurvey() {
        document.getElementById('step-intro').classList.add('hidden');
        document.getElementById('survey-container').classList.remove('hidden');
        document.getElementById('bottom-bar').classList.remove('hidden');
        movePage(1);
    }

    function movePage(dir) {
        // Validation (í•„ìˆ˜ í•­ëª© ì²´í¬ - ì˜ˆì‹œë¡œ 1í˜ì´ì§€ë§Œ)
        if(dir === 1 && currentPage === 1) {
            if(!document.getElementById('userName').value || !document.querySelector('input[name="gender"]:checked')) {
                return alert("ì„±ëª…ê³¼ ì„±ë³„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.");
            }
        }

        if(currentPage > 0) document.getElementById(`page-${currentPage}`).classList.add('hidden');
        
        currentPage += dir;
        if(currentPage < 1) currentPage = 1;
        
        // ì²™ë„ ë¡œì§ ì‹œì‘
        if(currentPage === 6) initScale('jarip');
        if(currentPage === 7) initScale('simni');
        if(currentPage > totalPages) { submitFinal(); return; }

        document.getElementById(`page-${currentPage}`).classList.remove('hidden');
        
        // ë²„íŠ¼/ì§„í–‰ë°” ì—…ë°ì´íŠ¸
        document.getElementById('progressBar').style.width = (currentPage / totalPages * 100) + "%";
        document.getElementById('btn-next').innerText = (currentPage === totalPages) ? "ì œì¶œí•˜ê¸°" : "ë‹¤ìŒ";
    }

    // ë°ì´í„° ìˆ˜ì§‘
    function collectData() {
        // ê°’ ì½ì–´ì˜¤ê¸°
        formData.name = document.getElementById('userName').value;
        formData.birth = document.getElementById('userBirth').value;
        formData.gender = getVal('gender');
        formData.rrn = document.getElementById('rrn1').value + "-" + document.getElementById('rrn2').value;
        formData.addr = document.getElementById('address').value;
        formData.email = document.getElementById('email').value;
        formData.msg = document.getElementById('messengerId').value;
        formData.telS = document.getElementById('telSelf').value;
        formData.telP = document.getElementById('telParent').value;
        formData.status = getVal('status');
        
        // í•™ì—…
        formData.schLvl = getVal('schLvl');
        formData.grade = getVal('grade');
        formData.sem = getVal('semester');
        formData.dropDate = `${document.getElementById('dropY').value}.${document.getElementById('dropM').value}.${document.getElementById('dropD').value}`;
        formData.reasons = [document.getElementById('reason1').value, document.getElementById('reason2').value, document.getElementById('reason3').value].filter(Boolean).join(", ");
        if(document.getElementById('reasonEtc').value) formData.reasons += `(${document.getElementById('reasonEtc').value})`;
        formData.agree = getVal('parentAgree');
        formData.path = getVal('visitPath');

        // ê°€ì¡±
        let fam = [];
        for(let i=1; i<=5; i++) {
            let r = document.getElementById(`fr${i}`).value;
            let n = document.getElementById(`fn${i}`).value;
            if(r && n) fam.push(`${r}/${n}`);
        }
        formData.family = fam.join(", ");
        formData.famType = getVal('famType');
        formData.econ = getVal('econ');
        formData.money = getVal('moneySat');
        formData.interest = getVal('famInterest');
        formData.talk = getVal('confidant');

        // ìš•êµ¬
        formData.diff = getChecks('diff');
        formData.goal = getVal('goal');
        formData.service = getChecks('service');
        formData.school = getVal('pastSchool');
        formData.health = getVal('health');
    }

    function getVal(name) {
        const el = document.querySelector(`input[name="${name}"]:checked`);
        return el ? el.value : "";
    }
    function getChecks(name) {
        let arr = [];
        document.querySelectorAll(`input[name="${name}"]:checked`).forEach(e => arr.push(e.value));
        return arr.join(", ");
    }

    // ì²™ë„ ë Œë”ë§
    function initScale(part) {
        collectData(); // ì•ë‹¨ê³„ ì €ì¥
        
        // ë‚˜ì´ ê³„ì‚° (YOUTH/CHILD êµ¬ë¶„)
        const bYear = parseInt(document.getElementById('rrn1').value.substr(0,2));
        const fullYear = bYear < 30 ? 2000+bYear : 1900+bYear;
        const age = new Date().getFullYear() - fullYear;
        scaleType = (age >= 13) ? "YOUTH" : "CHILD";

        const list = SCALE_DATA[scaleType][part];
        const area = document.getElementById(part+'-area');
        area.innerHTML = "";
        
        list.forEach((q, idx) => {
            area.innerHTML += `
                <div class="q-card">
                    <div class="q-text">${idx+1}. ${q.t}</div>
                    <div class="btn-group">
                        <label><input type="radio" name="${part}_${q.n}" value="1" onchange="saveAns('${part}',${q.n},1,${q.rev},${q.crit},'${q.d}')">ì „í˜€ì•„ë‹˜</label>
                        <label><input type="radio" name="${part}_${q.n}" value="2" onchange="saveAns('${part}',${q.n},2,${q.rev},${q.crit},'${q.d}')">ì•„ë‹ˆë‹¤</label>
                        <label><input type="radio" name="${part}_${q.n}" value="3" onchange="saveAns('${part}',${q.n},3,${q.rev},${q.crit},'${q.d}')">ë³´í†µ</label>
                        <label><input type="radio" name="${part}_${q.n}" value="4" onchange="saveAns('${part}',${q.n},4,${q.rev},${q.crit},'${q.d}')">ê·¸ë ‡ë‹¤</label>
                        <label><input type="radio" name="${part}_${q.n}" value="5" onchange="saveAns('${part}',${q.n},5,${q.rev},${q.crit},'${q.d}')">ë§¤ìš°ê·¸ë ‡ë‹¤</label>
                    </div>
                </div>
            `;
        });
    }

    function saveAns(part, n, v, r, c, d) {
        answers[`${part}_${n}`] = { val:v, rev:r, crit:c, domain:d };
    }

    function saveDraft() {
        alert("í˜„ì¬ê¹Œì§€ ë‚´ìš©ì´ ê¸°ê¸°ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
        localStorage.setItem('kdream_temp', "saved");
    }

    function submitFinal() {
        collectData();
        const payload = { info: formData, ans: answers, date: new Date().toLocaleDateString(), ts: firebase.firestore.FieldValue.serverTimestamp() };
        
        if(db) {
            db.collection("intake_complete").add(payload).then(() => {
                document.getElementById('page-end').classList.remove('hidden');
                document.getElementById('bottom-bar').classList.add('hidden');
                document.getElementById(`page-${totalPages}`).classList.add('hidden');
            });
        } else {
            alert("DB ì—°ê²° ì•ˆë¨ (í…ŒìŠ¤íŠ¸ ì™„ë£Œ)");
            document.getElementById('page-end').classList.remove('hidden');
            document.getElementById('bottom-bar').classList.add('hidden');
            document.getElementById(`page-${totalPages}`).classList.add('hidden');
        }
    }

    // ê´€ë¦¬ì ê¸°ëŠ¥
    function showAdmin() {
        document.getElementById('step-intro').classList.add('hidden');
        document.getElementById('admin-view').classList.remove('hidden');
    }
    
    function loginAdmin() {
        if(document.getElementById('adminPw').value === "1388") {
            document.getElementById('admin-view').classList.add('hidden');
            document.getElementById('admin-list').classList.remove('hidden');
            loadList();
        } else alert("ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜");
    }

    function loadList() {
        const ul = document.getElementById('list-area');
        ul.innerHTML = "ë¡œë”©ì¤‘...";
        if(!db) return;
        
        db.collection("intake_complete").orderBy("ts", "desc").limit(10).get().then(snap => {
            ul.innerHTML = "";
            snap.forEach(doc => {
                const d = doc.data();
                ul.innerHTML += `<li class="card" style="padding:15px; display:flex; justify-content:space-between;">
                    <b>${d.info.name} (${d.info.birth})</b> 
                    <button class="btn btn-next" style="width:auto; padding:5px 15px;" onclick='viewRpt(${JSON.stringify(d)})'>ë³´ê¸°</button>
                </li>`;
            });
        });
    }

    function viewRpt(d) {
        document.getElementById('admin-list').classList.add('hidden');
        document.getElementById('report-area').classList.remove('hidden');
        
        const i = d.info;
        // ê¸°ë³¸ì •ë³´
        document.getElementById('r-name').innerText = i.name;
        document.getElementById('r-birth').innerText = i.birth;
        document.getElementById('r-gender').innerText = i.gender;
        document.getElementById('r-addr').innerText = i.addr;
        document.getElementById('r-today').innerText = d.date;
        document.getElementById('r-tel-s').innerText = i.telS;
        document.getElementById('r-tel-p').innerText = i.telP;
        document.getElementById('r-email').innerText = i.email;
        document.getElementById('r-msg').innerText = i.msg;
        document.getElementById('r-status').innerText = i.status;

        // í•™ì—…
        document.getElementById('r-drop-when').innerText = `${i.schLvl} ${i.grade||''} ${i.sem||''}`;
        document.getElementById('r-drop-date').innerText = i.dropDate;
        document.getElementById('r-drop-reason').innerText = i.reasons;
        document.getElementById('r-agree').innerText = i.agree;
        document.getElementById('r-path').innerText = i.path;

        // ê°€ì¡±
        document.getElementById('r-family').innerText = i.family;
        document.getElementById('r-fam-type').innerText = i.famType;
        document.getElementById('r-econ').innerText = i.econ;
        document.getElementById('r-money').innerText = i.money;
        document.getElementById('r-interest').innerText = i.interest;
        document.getElementById('r-talk').innerText = i.talk;

        // ìš•êµ¬
        document.getElementById('r-diff').innerText = i.diff;
        document.getElementById('r-goal').innerText = i.goal;
        document.getElementById('r-service').innerText = i.service;
        document.getElementById('r-health').innerText = i.health;
        document.getElementById('r-school').innerText = i.school;

        // ì²™ë„ ê³„ì‚°
        let jScore={}, sScore={}, redFlag=[];
        for(let k in d.ans) {
            const item = d.ans[k];
            let v = item.val;
            if(item.rev) v = 6 - v;
            
            if(k.startsWith('jarip')) {
                if(!jScore[item.domain]) jScore[item.domain] = 0;
                jScore[item.domain] += v;
            } else {
                if(!sScore[item.domain]) sScore[item.domain] = 0;
                sScore[item.domain] += v;
                if(item.crit && item.val >= 3) redFlag.push(`${item.domain}: ${item.text} (${item.val})`);
            }
        }

        // ê²°ê³¼ í‘œ
        let h1="", h2="";
        for(let k in jScore) h1 += `<tr><td>${k}</td><td>${jScore[k]}</td><td>-</td></tr>`;
        for(let k in sScore) h2 += `<tr><td>${k}</td><td>${sScore[k]}</td><td>-</td></tr>`;
        
        document.getElementById('r-jarip-body').innerHTML = h1;
        document.getElementById('r-simni-body').innerHTML = h2;
        document.getElementById('r-redflag').innerHTML = redFlag.length ? redFlag.join("<br>") : "íŠ¹ì´ì‚¬í•­ ì—†ìŒ";
    }
</script>
</body>
</html>
